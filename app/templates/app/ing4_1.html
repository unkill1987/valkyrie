<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Title  -->
    <title>Valkyrie System|Valkyrie System</title>

    <!-- Favicon  -->
    <link rel="icon" href="{% static 'app/img/core-img/favicon.ico'%}">

    <!-- Core Style CSS -->
    <link rel="stylesheet" href="{% static 'app/css/core-style.css'%}">
    <link rel="stylesheet" href="{% static 'app/css/style.css'%}">

    <!-- Responsive CSS -->
    <link href="{% static 'app/css/responsive.css'%}" rel="stylesheet">

</head>

<body>
<!-- Preloader -->
<div id="preloader">
    <div class="showbox">
        <div class="loader">
            <svg class="circular" viewBox="25 25 50 50">
                <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2"
                        stroke-miterlimit="10"></circle>
            </svg>
        </div>
    </div>
    <div class="questions-area text-center">
        <p>Please Wait...</p>
        <ul>
            <li>Valkyrie Blockchain Trade System</li>
        </ul>
    </div>
</div>

<!-- Gradient Background Overlay -->
<div class="gradient-background-overlay"></div>

<!-- Header Area Start -->
<header class="header-area bg-img" style="background-image: url(../../static/app/img/bg-img/14.jpg);">
    <div class="container-fluid h-100">
        <div class="row h-100 align-items-center">
            <div class="col-12 h-100">
                <div class="main-menu h-100">
                    <nav class="navbar h-100 navbar-expand-lg">
                        <!-- Logo Area  -->
                        <a class="navbar-brand" href="{% url 'index4' %}"><img
                                src="{% static 'app/img/core-img/logo.png'%}"
                                alt="Logo"></a>

                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#studioMenu"
                                aria-controls="studioMenu" aria-expanded="false" aria-label="Toggle navigation"><i
                                class="fa fa-bars"></i> Menu
                        </button>

                        <div class="collapse navbar-collapse" id="studioMenu">
                            <!-- Menu Area Start  -->
                            <ul class="navbar-nav ml-auto">
                                <li class="nav-item active">
                                    <a class="nav-link" href="{% url 'index4'%}">Home </a>
                                </li>
                                <li class="nav-item active">
                                    <a class="nav-link" href="{% url 'charts'%}">환율정보</a>
                                </li>
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown"
                                       aria-haspopup="true" aria-expanded="false">문서 작성</a>
                                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                        <a class="dropdown-item" href="{% url 'forms4_1'%}">선하증권</a>
                                        <a class="dropdown-item" href="{% url 'forms4_2'%}">인도지시서</a>
                                    </div>
                                </li>
                                <li class="nav-item dropdown"
                                    style="height:80px;border-top:5px solid #ffffff00;border-bottom:5px solid #ff8a12">
                                    <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown"
                                       aria-haspopup="true" aria-expanded="false">작성 문서 관리</a>
                                    <div class="dropdown-menu" aria-labelledby="navbarDropdown"
                                         style="margin-top: 5px;">
                                        <a class="dropdown-item" href="{% url 'ing4_1'%}">선하증권</a>
                                        <a class="dropdown-item" href="{% url 'ing4_2'%}">인도지시서</a>
                                    </div>
                                </li>
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown"
                                       aria-haspopup="true" aria-expanded="false">받은 문서 관리</a>
                                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                        <a class="dropdown-item" href="{% url 'srreceived'%}">선적요청서</a>

                                    </div>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="{% url 'mypage4'%}">MYPAGE</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="" data-toggle="modal"
                                       data-target="#logoutModal">LOGOUT</a>
                                </li>
                            </ul>
                            <!-- Search Form -->

                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- Header Area End -->


<form method="post">
    <!--Valkyrie System Area Start -->
    <section class="blog-area section_padding_100 mt-100">
        <div class="container">
            <div class="row justify-content-center">
                <div class="container-fluid" style="margin:5px; margin-bottom:10px;">
                    <h4>선하증권 관리({{total_len}}건) - {{filter}}</h4>
                    <form method="post">
                        <select class="custom-select" id="filter" name="filter" style="width:130px">
                            <option value="all">All</option>
                            <option value="new">New</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="rejected">Rejected</option>
                        </select>
                        <button class="btn btn-outline-dark" formaction="{% url 'ing4_1' %}"> 조회</button>
                        {% csrf_token %}
                    </form>
                    <div class="row">
                        {% for c in result_list %}
                        <div class="col-lg-4 mb-4" style="margin-bottom:30px; margin-top:30px">

                            <input type="checkbox" id="{{c.id}}" name="check_id" value="{{ c.id }}"><a>Check</a>
                            <div class="card h-100">

                                <h5 class="card-header">

                                    <div id="status" style="color:orange">{{c.status}}</div>
                                    <hr>
                                    Contract ID.<br>{{c.contract_id}}
                                    <hr>

                                    {{c.contractname}}
                                </h5>
                                <div class="card-body">
                                    <h5>Document Hash:<br>{{c.sha256}}</h5>
                                </div>
                                <div class="card-footer">
                                    <a href="{% url 'download4_1' %}?id={{ c.id }}" class="btn btn-outline-dark"
                                       target="_blank">
                                        View
                                    </a>
                                    <hr>
                                    <h6>To (수입자ID):<br>{{c.share1}}</h6>
                                    <h6>To (수출자ID):<br>{{c.share2}}</h6>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                        <hr>
                    </div>

                    <hr>
                    <div class="wrapper">
                        {% if result_list.has_other_pages %}
                        <ul class="pagination" style="display: flex; justify-content: center;">
                            {% if result_list.has_previous %}
                            <li>
                                <a class="btn btn-outline-dark" href="?page={{ result_list.previous_page_number }}"
                                   style="border-top-left-radius:5px;border-bottom-left-radius:5px;">
                                    &laquo;
                                </a>

                            </li>
                            {% else %}
                            <li class="btn btn-outline-dark disabled"
                                style="border-top-left-radius:5px;border-bottom-left-radius:5px;">
                                <span>&laquo;</span></li>
                            {% endif %}

                            {% if result_list.number > 2 %}
                            <li><a href="?page={{ 1 }}" class="btn btn-outline-dark">
                                1
                            </a></li>
                            <li><span><a class="btn btn-outline-dark">...<span class="sr-only">...</span></a></span>
                            </li>
                            {% endif %}
                            {% for i in page_range %}
                            {% if result_list.number == i %}
                            <li class="btn btn-outline-dark active"><span style="color:white;">{{ i }}<span
                                    class="sr-only">(current)</span></span>
                            </li>
                            {% else %}
                            <li><a class="btn btn-outline-dark" href="?page={{ i }}">
                                {{ i }}
                            </a></li>
                            {% endif %}
                            {% endfor %}
                            {% if result_list.number < max_index %}
                            <li><span><a class="btn btn-outline-dark">...<span class="sr-only">...</span></a></span>
                            </li>
                            <li><a class="btn btn-outline-dark" href="?page={{ max_index|add:'2' }}">
                                {{ max_index|add:"2" }}
                            </a>
                            </li>
                            {% endif %}
                            {% if result_list.has_next %}
                            <li>
                                <a class="btn btn-outline-dark" href="?page={{ result_list.next_page_number }}"
                                   style="border-top-right-radius:5px;border-bottom-right-radius:5px;">
                                    &raquo;
                                </a>
                            </li>
                            {% else %}
                            <li>
                <span><a class="btn btn-outline-dark disabled"
                         style="border-top-right-radius:5px;border-bottom-right-radius:5px;">&raquo;</a></span>
                            </li>
                            {%endif %}
                        </ul>
                        {%endif%}
                    </div>

                    <div class="row">

                        <div style="text-align:center; margin:auto;"><a>수입자ID:</a>
                            <input class="form-control" name="share_user" id="share_user">
                            <a>수출자ID:</a>
                            <input class="form-control" name="share_user2" id="share_user2">
                            <br>
                            <a class="btn btn-outline-dark" data-toggle="modal" id="submit"
                               data-target="#otpmodal">전송하기</a>
                            <a id="delete" class="btn btn-outline-dark" data-toggle="modal"
                               data-target="#deleteModal">선택삭제</a>


                        </div>
                    </div>
                    <div class="modal fade" id="otpmodal" tabindex="-1" role="dialog"
                         aria-labelledby="exampleModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Enter otp</h5>
                                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                                <div class="modal-body">Input your OTP Number:
                                    <input name="otp" class="form-control">
                                </div>
                                <div class="modal-footer">
                                    <a class="btn" style="color:white;background:#ff8a12;" id="share">Send</a>
                                    <a style="color:white;" class="btn btn-dark" data-dismiss="modal">Cancel</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog"
                         aria-labelledby="exampleModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Are you sure?</h5>
                                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                                <div class="modal-body">Select "Delete" below if you are ready to delete your
                                    documents.
                                </div>
                                <div class="modal-footer">
                                    <a style="color:white;" class="btn btn-dark" data-dismiss="modal">Cancel</a>
                                    <a class="btn" style="color:white;background:#ff8a12;" id="delete_btn">Delete</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--</form>-->
                </div>

                <!-- Sticky Footer -->
            </div>


        </div>
        <!-- /.content-wrapper -->

    </section>
    {% csrf_token %}
</form>
<!--Valkyrie System Area End -->

<!-- Footer Area Start -->
<footer class="footer-area">
    <div class="container-fluid h-100">
        <div class="row h-100">
            <div class="col-12 h-100" style="padding-right:0px;">
                <div class="footer-content h-100 d-md-flex align-items-center justify-content-between">
                    <!-- Single Footer Content -->
                    <div class="single-footer-content">
                        <i class="fa fa-wifi"></i>
                        <a>valkyriesystem.online</a>
                    </div>
                    <!-- Single Footer Content -->
                    <div class="single-footer-content">
                        <i class="fa fa-copyright"></i>
                        <a>Operation Valkyrie</a>
                    </div>
                    <!-- Single Footer Content -->
                    <div style="height:50px;background:#ff7b07;padding:10px" class="single-footer-content">
                        <i class="fa fa-file-text-o"></i>
                        <a href="{% url 'user_manual' %}" target="_blank">User Manual</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- Footer Area End -->

<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
            <div class="modal-footer">
                <a style="color:white;" class="btn btn-dark" data-dismiss="modal">Cancel</a>
                <a class="btn" style="color:white;background:#ff8a12;" href="{% url 'logout' %}">Logout</a>
            </div>
        </div>
    </div>
</div>
<!-- jQuery (Necessary for All JavaScript Plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<!-- Popper js -->
<script src="{% static 'app/js/popper.min.js'%}"></script>
<!-- Bootstrap js -->
<script src="{% static 'app/js/bootstrap.min.js'%}"></script>
<!-- Plugins js -->
<script src="{% static 'app/js/plugins.js'%}"></script>
<!-- Active js -->
<script src="{% static 'app/js/active.js'%}"></script>

</body>
<script>
  $(document).ready(function(){
  $('#preloader').hide();
});

    $('#submit').click(function() {
        var share_user = $('#share_user').val();
        var check_id = $('input:checked').val();

        if (share_user.length == 0) {
            alert("전송대상을 입력하세요");
            return false;
         }else if  (check_id == null) {
            alert("전송할 문서를 선택하세요");
            return false;
         }else{

         }
    });

     $('#delete').click(function() {
    var check_id = $('input:checked').val();

   if  (check_id == null) {
        alert("삭제할 문서를 선택하세요");
        return false;
     }else{
     }
    });

     $('#share').click(function(){
     $('.btn').attr('disabled',true);
      $('#preloader').show();
     $.ajax({
        url:'/share4_1/',
        type:'post',
        data:$('form').serialize(),
        success: function(res){
            if (res.result == 'Success'){
                alert(res.result)
                location = '/BL/'
                }else{
                alert(res.result)
                location = '/BL/'
                }
            }
        })
        return false
     })

$('#delete_btn').click(function() {
    $('.btn').attr('disabled',true);
        check_ids = ''
        sep = ''
        $('input:checked').each(function() {
          check_ids += sep + $(this).val()
          sep = ','
        });
        $.ajax({
            url:'/remove4_1/',
            type:'post',
            dataType:'json',
            data:{check_ids:check_ids},
            success:function(res){
                alert(res.result)
                if (res.result == 'deleted'){
                    location ='/BL/'
                }
            }
        });
        return false;
      });







</script>

</html>
